import"../chunks/DsnmJJEf.js";import{i as Ze}from"../chunks/DQsoHn4k.js";import{k as ea,u as j,h as Nt,aW as ta,n as Ma,aX as ja,aY as Ia,a0 as aa,V as ht,aL as xa,l as Ca,aZ as Ea,a5 as za,H as ct,p as Qe,w as s,y as b,a3 as kt,x as e,a_ as na,aB as we,E as R,aC as gt,f as H,i as l,r as o,s as d,t as me,j as ye,v as E,d as k,e as et,aD as We,aE as wt,c as lt,a$ as Oa,aJ as Lt,a8 as rt,b0 as qt,b1 as sa,aA as Aa,b2 as $a,b3 as Pa,b4 as Na,aN as Vt}from"../chunks/B-dIStYR.js";import{p as z,i as _e,s as Ct,a as St}from"../chunks/dJ6LLPXz.js";import{t as qa,s as Ne,e as Re,i as Ue}from"../chunks/701SNvb-.js";import{b as Fa,_ as Xt}from"../chunks/FH-h-fq2.js";import{s as pt,r as bt}from"../chunks/k2V-CE24.js";import"../chunks/BUKsf6PK.js";import{s as La,b as Ra}from"../chunks/Chlsm5re.js";import{E as Ha}from"../chunks/CGN9b_xH.js";import{a as Rt}from"../chunks/BzgOtexE.js";function Ya(t,a,n){ea(()=>{var i=j(()=>a(t,n?.())||{});if(i?.destroy)return()=>i.destroy()})}function Xe(t,a,n,i){var g=t.__style;if(Nt||g!==a){var p=qa(a);(!Nt||p!==t.getAttribute("style"))&&(p==null?t.removeAttribute("style"):t.style.cssText=p),t.__style=a}return i}function ra(t,a,n=!1){if(t.multiple){if(a==null)return;if(!Ma(a))return ja();for(var i of t.options)i.selected=a.includes(_t(i));return}for(i of t.options){var g=_t(i);if(Ia(g,a)){i.selected=!0;return}}(!n||a!==void 0)&&(t.selectedIndex=-1)}function Wa(t){var a=new MutationObserver(()=>{ra(t,t.__value)});a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),aa(()=>{a.disconnect()})}function Ft(t,a,n=a){var i=!0;ta(t,"change",g=>{var p=g?"[selected]":":checked",S;if(t.multiple)S=[].map.call(t.querySelectorAll(p),_t);else{var w=t.querySelector(p)??t.querySelector("option:not([disabled])");S=w&&_t(w)}n(S)}),ea(()=>{var g=a();if(ra(t,g,i),i&&g===void 0){var p=t.querySelector(":checked");p!==null&&(g=_t(p),n(g))}t.__value=g,i=!1}),Wa(t)}function _t(t){return"__value"in t?t.__value:t.value}function at(t,a,n=a){var i=new WeakSet;ta(t,"input",async g=>{var p=g?t.defaultValue:t.value;if(p=At(t)?$t(p):p,n(p),ht!==null&&i.add(ht),await xa(),p!==(p=a())){var S=t.selectionStart,w=t.selectionEnd;t.value=p??"",w!==null&&(t.selectionStart=S,t.selectionEnd=Math.min(w,t.value.length))}}),(Nt&&t.defaultValue!==t.value||j(a)==null&&t.value)&&(n(At(t)?$t(t.value):t.value),ht!==null&&i.add(ht)),Ca(()=>{var g=a();if(t===document.activeElement){var p=Ea??ht;if(i.has(p))return}At(t)&&g===$t(t.value)||t.type==="date"&&!g&&!t.value||g!==t.value&&(t.value=g??"")})}function At(t){var a=t.type;return a==="number"||a==="range"}function $t(t){return t===""?null:+t}function Ua(t,a,n){var i=za(t,a);i&&i.set&&(t[a]=n,aa(()=>{t[a]=null}))}const ft={background:"#f5f5f5",bubbleBackground:"#e0e0e0",buttonPrimary:"#666666",buttonHover:"#808080",buttonText:"#ffffff",textPrimary:"#333333"},dt=ct(null),Ve=ct(null),oa="major_tasks",ia="task_counter";function Ba(t){try{localStorage.setItem(oa,JSON.stringify(t))}catch(a){console.warn("Failed to save major tasks to localStorage:",a)}}function Ka(){try{const t=localStorage.getItem(oa);return t?JSON.parse(t):[]}catch(t){return console.warn("Failed to load major tasks from localStorage:",t),[]}}function Ja(t){try{localStorage.setItem(ia,t.toString())}catch(a){console.warn("Failed to save task counter to localStorage:",a)}}function Va(){try{const t=localStorage.getItem(ia);return t?parseInt(t,10):1}catch(t){return console.warn("Failed to load task counter from localStorage:",t),1}}const Ge=ct(Ka()),Ht=ct(Va());Ge.subscribe(Ba);Ht.subscribe(Ja);function Tt(t=new Date){const a=new Date(t),n=a.getDay(),i=a.getDate()-n+(n===0?-6:1);return a.setDate(i),a.toISOString().split("T")[0]}function la(){let t=1;return Ht.update(a=>(t=a,a+1)),t.toString()}function da(t,a,n,i,g,p,S="medium"){const w=la(),x=a?`${a} #${w}`:`Sample Task #${w}`;return{id:w,title:x,description:n||`Task description for ${x}`,color:i||"red",startDay:g||1,endDay:p||3,weekStart:t,priority:S}}function Xa(t,a){Ge.update(n=>n.map(i=>i.id===t?{...i,...a}:i))}function ca(t){Ge.update(a=>a.filter(n=>n.id!==t))}const Gt=Object.freeze(Object.defineProperty({__proto__:null,createNewTask:da,deleteTask:ca,generateTaskId:la,getWeekStart:Tt,majorTasks:Ge,taskCounter:Ht,updateMajorTask:Xa},Symbol.toStringTag,{value:"Module"}));var Ga=H('<div class="task-description"> </div>'),Za=H('<button type="button" class="delete-button" aria-label="Delete task">√ó</button>'),Qa=H('<div class="delete-confirmation"><span class="confirm-text">Delete task?</span> <div class="confirm-buttons"><button type="button" class="confirm-btn cancel-btn">Cancel</button> <button type="button" class="confirm-btn delete-btn">Delete</button></div></div>'),en=H('<div role="button" tabindex="0"><div class="task-content"><span class="task-title"> </span> <!></div> <!> <!></div>');function tn(t,a){Qe(a,!1);const n=b(),i=b();let g=z(a,"id",8),p=z(a,"title",8),S=z(a,"description",8),w=z(a,"color",8),x=z(a,"startDay",8),W=z(a,"endDay",8),B=b(!1),Y=b(!1),A=b(!1),f=b(!1);const Se=Ve.subscribe(I=>{s(A,I===g()),J()}),de=dt.subscribe(()=>{J()});function J(){const I=kt(Ve),ie=kt(dt);I!==null||ie!==null?s(f,!e(A)):s(f,!1)}na(()=>{Se(),de()});function he(){s(B,!0),Ve.set(g())}function je(){s(B,!1),s(Y,!1),Ve.set(null)}function $(I){I.stopPropagation(),s(Y,!0)}function pe(I){I.stopPropagation(),ca(g()),s(Y,!1)}function te(I){I.stopPropagation(),s(Y,!1)}we(()=>R(x()),()=>{s(n,x()+1)}),we(()=>R(W()),()=>{s(i,W()+2)}),gt(),Ze();var V=en();let ae;var Z=l(V),Ie=l(Z),ne=l(Ie,!0);o(Ie);var C=d(Ie,2);{var u=I=>{var ie=Ga(),y=l(ie,!0);o(ie),me(()=>ye(y,S())),k(I,ie)};_e(C,I=>{e(B)&&I(u)})}o(Z);var D=d(Z,2);{var ce=I=>{var ie=Za();E("click",ie,$),k(I,ie)};_e(D,I=>{e(B)&&!e(Y)&&I(ce)})}var se=d(D,2);{var Te=I=>{var ie=Qa(),y=d(l(ie),2),m=l(y),N=d(m,2);o(y),o(ie),E("click",m,te),E("click",N,pe),k(I,ie)};_e(se,I=>{e(Y)&&I(Te)})}o(V),me(I=>{ae=Ne(V,1,"major-task-bar",null,ae,I),pt(V,"id","major-task-"+g()),Xe(V,`background-color: ${w()??""}; grid-column: ${e(n)??""} / ${e(i)??""};`),ye(ne,p())},[()=>({hovered:e(B),highlighted:e(A),dimmed:e(f)})]),E("mouseenter",V,he),E("mouseleave",V,je),k(t,V),et()}var an=H('<div class="timeline-container"><div class="timeline-header"><div class="timeline-spacer"></div> <div class="day-separator"></div> <div class="day-separator"></div> <div class="day-separator"></div> <div class="day-separator"></div> <div class="day-separator"></div> <div class="day-separator"></div> <div class="day-separator"></div> <!></div></div>');function nn(t,a){Qe(a,!1);const n=()=>St(Ge,"$majorTasks",i),[i,g]=Ct(),p=b();let S=z(a,"weekDates",24,()=>[]),w=b("");we(()=>(R(S()),Tt),()=>{S().length>0&&s(w,Tt(S()[0]))}),we(()=>(n(),e(w)),()=>{s(p,n().filter(Y=>Y.weekStart===e(w)))}),gt(),Ze();var x=an(),W=l(x),B=d(l(W),16);Re(B,1,()=>e(p),Y=>Y.id,(Y,A)=>{tn(Y,{get id(){return e(A),j(()=>e(A).id)},get title(){return e(A),j(()=>e(A).title)},get description(){return e(A),j(()=>e(A).description)},get color(){return e(A),j(()=>e(A).color)},get startDay(){return e(A),j(()=>e(A).startDay)},get endDay(){return e(A),j(()=>e(A).endDay)}})}),o(W),o(x),k(t,x),et(),g()}const ua="calendar_subtasks",va="subtask_counter";function sn(t){if(!(typeof window>"u"))try{localStorage.setItem(ua,JSON.stringify(t))}catch(a){console.warn("Failed to save subtasks to localStorage:",a)}}function rn(){if(typeof window>"u")return[];try{const t=localStorage.getItem(ua);return t?JSON.parse(t):[]}catch(t){return console.warn("Failed to load subtasks from localStorage:",t),[]}}function on(t){if(!(typeof window>"u"))try{localStorage.setItem(va,t.toString())}catch(a){console.warn("Failed to save subtask counter to localStorage:",a)}}function ln(){if(typeof window>"u")return 1;try{const t=localStorage.getItem(va);return t?parseInt(t,10):1}catch(t){return console.warn("Failed to load subtask counter from localStorage:",t),1}}const Dt=ct(rn()),ma=ct(ln());Dt.subscribe(sn);ma.subscribe(on);function dn(){let t=1;return ma.update(a=>(t=a,a+1)),t}function cn(t,a,n,i,g,p="pending",S,w,x="medium"){const W=dn();return{id:W,date:t,startTime:a,endTime:n,title:i||`Subtask #${W}`,description:g||"",status:p}}function un(t){Dt.update(a=>a.filter(n=>n.id!==t))}function ot(t,a){Dt.update(n=>n.map(i=>i.id===t?{...i,...a}:i))}function it(t){const[a,n]=t.split(":").map(Number);return a*60+n}function It(t){const a=Math.floor(t/60)%24,n=t%60;return`${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function Pt(t){const a=it(t.startTime);return it(t.endTime)-a}var vn=H('<div class="linked-major-task"><span>Major Task:</span> <span class="linked-title"><!></span></div>'),mn=H('<div class="subtask-content svelte-1lbqrh"><span class="subtask-title svelte-1lbqrh"> </span></div> <!>',1),fn=H('<div><div class="subtask-positioner svelte-1lbqrh"><div class="resize-handle resize-top svelte-1lbqrh" role="button" tabindex="0" aria-label="Resize top"></div> <div role="button" tabindex="0"><div class="task-badges svelte-1lbqrh"><div><!></div> <button type="button"><!></button></div> <!></div> <div class="resize-handle resize-bottom svelte-1lbqrh" role="button" tabindex="0" aria-label="Resize bottom"></div></div></div>');function bn(t,a){Qe(a,!1);const n=()=>St(dt,"$hoveredSubtaskId",g),i=()=>St(Ve,"$hoveredMajorTaskId",g),[g,p]=Ct(),S=b(),w=b(),x=b(),W=b(),B=b(),Y=b(),A=b();let f=z(a,"subtask",8),Se=z(a,"gridColumn",8);const de=1;let J=z(a,"pixelsPerHour",8),he=z(a,"isBeingDragged",8,!1),je=z(a,"onDragStart",8),$=z(a,"onClick",8),pe=z(a,"onResize",8),te=z(a,"onStatusChange",8),V=b(null),ae=b("#333");const Z=15,Ie=20,ne=5;let C=b(!1),u=b(null),D=0,ce=0,se=0,Te=0,I=0,ie=!1,y=b(0),m=b(0);function N(c){const[_,M]=c.split(":").map(Number);return _*60+M}function q(c){return Math.round(c/Z)*Z}function F(c){let _=!1,M=null,ee=0,ve=0;const oe=ge=>{if(ge.target.closest(".status-badge")||ge.target.closest(".resize-handle"))return;Te=ge.clientX,I=ge.clientY,ie=!1;const T=c.getBoundingClientRect();ee=ge.clientX-T.left,ve=ge.clientY-T.top;const P=Ee=>{const ut=Math.abs(Ee.clientX-Te),Ye=Math.abs(Ee.clientY-I);!_&&(ut>ne||Ye>ne)&&(_=!0,ie=!0,Ee.preventDefault(),document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",M=c.cloneNode(!0),M.classList.add("drag-ghost"),M.style.position="fixed",M.style.left=`${T.left}px`,M.style.top=`${T.top}px`,M.style.width=`${T.width}px`,M.style.height=`${T.height}px`,M.style.pointerEvents="none",M.style.zIndex="2000",M.style.opacity="0.8",document.body.appendChild(M),c.style.opacity="0.3",je()(Ee),window.removeEventListener("mousemove",P),window.addEventListener("mousemove",xe))},xe=Ee=>{!_||!M||(Ee.preventDefault(),M.style.left=`${Ee.clientX-ee}px`,M.style.top=`${Ee.clientY-ve}px`)},Le=()=>{_&&(M?.remove(),M=null,c.style.opacity="1",_=!1,document.body.style.userSelect="",document.body.style.webkitUserSelect=""),window.removeEventListener("mousemove",P),window.removeEventListener("mousemove",xe),window.removeEventListener("mouseup",Le)};window.addEventListener("mousemove",P),window.addEventListener("mouseup",Le)};return c.addEventListener("mousedown",oe),{destroy(){c.removeEventListener("mousedown",oe),document.body.style.userSelect="",document.body.style.webkitUserSelect=""}}}function L(c,_){c.stopPropagation(),c.preventDefault(),s(C,!0),s(u,_),se=c.clientY,D=N(f().startTime),ce=N(f().endTime),s(y,D),s(m,ce),document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.body.style.cursor="ns-resize";const M=ve=>{if(!e(C))return;ve.preventDefault();const ge=(ve.clientY-se)/J()*60;if(e(u)==="bottom"){const T=ce+ge,P=q(T);P>e(y)&&P<=1440&&s(m,P)}else if(e(u)==="top"){const T=D+ge,P=q(T);P>=0&&P<e(m)&&s(y,P)}},ee=()=>{e(u)==="bottom"?pe()(e(y),e(m)):e(u)==="top"&&pe()(e(y),e(m)),s(C,!1),s(u,null),document.body.style.userSelect="",document.body.style.webkitUserSelect="",document.body.style.cursor="",window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",ee)};window.addEventListener("mousemove",M),window.addEventListener("mouseup",ee)}function Q(){ie||$()(),ie=!1}function U(c){c.stopPropagation();let _;f().status==="pending"?_="completed":f().status==="completed"?_="cancelled":_="pending",te()(_)}we(()=>(R(f()),e(V),Ge),()=>{f().majorTaskId?(s(V,kt(Ge).find(c=>c.id===f().majorTaskId)||null),e(V)&&e(V).color?s(ae,e(V).color):s(ae,"#333")):(s(V,null),s(ae,"#333"))}),we(()=>(e(C),e(u),e(y),R(f())),()=>{s(S,e(C)&&e(u)==="top"?e(y):N(f().startTime))}),we(()=>(e(C),e(u),e(m),R(f())),()=>{s(w,e(C)&&e(u)==="bottom"?e(m):N(f().endTime))}),we(()=>(e(w),e(S)),()=>{s(x,e(w)-e(S))}),we(()=>e(x),()=>{s(W,e(x)/60)}),we(()=>(e(W),R(J())),()=>{s(B,e(W)*J()>=Ie)}),we(()=>(e(S),R(J())),()=>{s(Y,e(S)/60*J())}),we(()=>(e(x),R(J())),()=>{s(A,e(x)/60*J())}),gt();var ue={gridRow:de};Ze();var X=fn();let fe;var le=l(X),ke=l(le),re=d(ke,2);let ze;var qe=l(re),Oe=l(qe),Be=l(Oe);{var Ae=c=>{var _=We("üî¥");k(c,_)},$e=c=>{var _=wt(),M=lt(_);{var ee=oe=>{var ge=We("üü¢");k(oe,ge)},ve=oe=>{var ge=We("üü°");k(oe,ge)};_e(M,oe=>{R(f()),j(()=>f().priority==="low")?oe(ee):oe(ve,!1)},!0)}k(c,_)};_e(Be,c=>{R(f()),j(()=>f().priority==="high")?c(Ae):c($e,!1)})}o(Oe);var Ce=d(Oe,2),De=l(Ce);{var He=c=>{var _=We("‚úì");k(c,_)},Me=c=>{var _=wt(),M=lt(_);{var ee=oe=>{var ge=We("‚úï");k(oe,ge)},ve=oe=>{var ge=We("‚óã");k(oe,ge)};_e(M,oe=>{R(f()),j(()=>f().status==="cancelled")?oe(ee):oe(ve,!1)},!0)}k(c,_)};_e(De,c=>{R(f()),j(()=>f().status==="completed")?c(He):c(Me,!1)})}o(Ce),o(qe);var Fe=d(qe,2);{var tt=c=>{var _=mn(),M=lt(_),ee=l(M),ve=l(ee,!0);o(ee),o(M);var oe=d(M,2);{var ge=T=>{var P=vn(),xe=d(l(P),2),Le=l(xe);{var Ee=Ye=>{var vt=We();me(()=>ye(vt,(e(V),j(()=>e(V).title)))),k(Ye,vt)},ut=Ye=>{var vt=We("(not found)");k(Ye,vt)};_e(Le,Ye=>{e(V)?Ye(Ee):Ye(ut,!1)})}o(xe),o(P),k(T,P)};_e(oe,T=>{R(f()),j(()=>f().majorTaskId)&&T(ge)})}me(()=>ye(ve,(R(f()),j(()=>f().title)))),k(c,_)};_e(Fe,c=>{e(B)&&c(tt)})}o(re);var G=d(re,2);o(le),Ya(le,c=>F?.(c)),o(X),me((c,_)=>{fe=Ne(X,1,"floating-subtask svelte-1lbqrh",null,fe,c),Xe(X,`
        grid-column: ${Se()??""};
        grid-row: 1 / -1;
        pointer-events: none;
    `),Xe(le,`
            position: absolute;
            top: ${e(Y)??""}px;
            height: ${e(A)??""}px;
            width: 100%;
            pointer-events: auto;
            z-index: 51;
        `),ze=Ne(re,1,"subtask-card svelte-1lbqrh",null,ze,_),pt(re,"id",(R(f()),j(()=>"subtask-"+f().id))),Xe(re,`border-color: ${e(ae)??""};`),Ne(Oe,1,`priority-badge ${R(f()),j(()=>f().priority||"medium")??""}`,"svelte-1lbqrh"),Ne(Ce,1,`status-badge ${R(f()),j(()=>f().status||"pending")??""}`,"svelte-1lbqrh")},[()=>({"being-dragged":he(),resizing:e(C)}),()=>({minimal:!e(B),highlighted:n()!==null&&(n()===f().id||i()===f().majorTaskId)||i()!==null&&i()===f().majorTaskId,dimmed:i()!==null&&i()!==f().majorTaskId||n()!==null&&!(n()===f().id||i()===f().majorTaskId)})]),E("mousedown",ke,c=>L(c,"top")),E("click",Ce,U),E("mouseenter",re,()=>{dt.set(f().id),Ve.set(f().majorTaskId||null)}),E("mouseleave",re,()=>{dt.set(null),Ve.set(null)}),E("click",re,Q),E("keydown",re,c=>c.key==="Enter"&&Q()),E("mousedown",G,c=>L(c,"bottom")),k(t,X),Ua(a,"gridRow",de);var K=et(ue);return p(),K}var pn=H('<div><div class="day-name"> </div> <div> </div></div>'),gn=H('<div style="background: rgba(255,255,255,0.01); cursor: pointer;" role="gridcell" tabindex="0"></div>'),yn=H('<div class="time-row"><div class="time-slot"> </div> <!></div>'),hn=H('<div class="calendar-grid"><svg id="subtask-major-lines" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; clip-path: inset(0 0 0 0);"></svg> <div class="grid-header"><div class="time-column-header"></div> <!></div> <!> <div class="grid-body svelte-1q5lr4u"><!> <div class="subtasks-layer"></div></div></div>');function _n(t,a){Qe(a,!1);let n=z(a,"weekDates",8),i=z(a,"timeSlots",8),g=z(a,"daysOfWeek",8),p=z(a,"eventsIndex",8),S=z(a,"pixelsPerHour",8),w=z(a,"handleCellClick",8),x=z(a,"formatDate",8),W=z(a,"isToday",8),B=z(a,"onEventMove",8),Y=z(a,"onSubtaskClick",8),A=z(a,"onSubtaskResize",8),f=z(a,"onStatusChange",8),Se=new Date().getHours(),de=b(null),J=b(null),he=b();function je(y,m){console.log("openSubtaskModal called:",y,m),w()(y,m)}function $(y){const m=new Date;m.setHours(0,0,0,0);const N=new Date(y);return N.setHours(0,0,0,0),N<m}function pe(y){s(de,y),s(J,y)}function te(y,m){if(!e(de))return;const N=e(de).split("|"),q={date:N[0],time:N[1]},F={date:y,time:m};if(q.date===F.date&&q.time===F.time){s(de,null),s(J,null);return}const L=`${y}|${m}`;if(p()[L]){s(de,null),s(J,null);return}B()(q,F),setTimeout(()=>{const Q=Object.values(p()).find(U=>U.date===F.date&&U.startTime===F.time);if(Q&&Q.majorTaskId){const ue=Object.values(p()).filter(X=>X.majorTaskId===Q.majorTaskId).map(X=>n().findIndex(le=>le.toISOString().split("T")[0]===X.date)+1).filter(X=>X>0);if(ue.length>0){const X=Math.min(...ue),fe=Math.max(...ue);Xt(()=>Promise.resolve().then(()=>Gt),void 0,import.meta.url).then(le=>{le.updateMajorTask(Q.majorTaskId,{startDay:X,endDay:fe})})}}},0),s(de,null),s(J,null)}function V(y){Y()(y)}const ae=[];function Z(){if(typeof window>"u")return;ae.length=0;const y=document.getElementById("subtask-major-lines"),m=document.querySelector(".grid-header");if(!y||!m){console.log("SVG element or grid header not found");return}const N=m.offsetHeight;for(;y.firstChild;)y.removeChild(y.firstChild);console.log("Drawing lines, eventsIndex:",p());const q=kt(dt),F=kt(Ve);Object.values(p()).forEach(L=>{if(console.log("Checking subtask:",L.id,"majorTaskId:",L.majorTaskId),!L.majorTaskId)return;const Q=document.getElementById("subtask-"+L.id),U=document.getElementById("major-task-"+L.majorTaskId);console.log("Elements found:",{subtaskEl:!!Q,majorTaskEl:!!U,subtaskId:"subtask-"+L.id,majorTaskId:"major-task-"+L.majorTaskId});var ue=0;let X=!1;for(let Fe of ae){if(Fe===L.majorTaskId){X=!0;break}ue+=1}if(X||ae.push(L.majorTaskId),!Q||!U)return;const fe=Q.getBoundingClientRect(),le=U.getBoundingClientRect(),ke=y.getBoundingClientRect();console.log("Amount of lines : "+ue);const re=fe.left-ke.left-8+ue*5,ze=Math.max(fe.top-ke.top+fe.height/2,N),qe=re,Oe=Math.max(le.top-ke.top+4,N);if(fe.top<ke.top+N)return;console.log("Drawing line from",{startX:re,startY:ze},"to",{endX:qe,endY:Oe});const Ae=window.getComputedStyle(U).backgroundColor||"#333";let $e=.9,Ce="";(q!==null||F!==null)&&(q===L.id||F===L.majorTaskId||($e=.3,Ce="grayscale(0.7) brightness(0.7)"));const De=document.createElementNS("http://www.w3.org/2000/svg","line");De.setAttribute("x1",re.toString()),De.setAttribute("y1",ze.toString()),De.setAttribute("x2",qe.toString()),De.setAttribute("y2",Oe.toString()),De.setAttribute("stroke",Ae),De.setAttribute("stroke-width","3"),De.setAttribute("opacity",$e.toString()),De.setAttribute("pointer-events","none"),De.setAttribute("z-index","50"),Ce&&De.setAttribute("style",`filter: ${Ce};`),y.appendChild(De);const He=re+15,Me=document.createElementNS("http://www.w3.org/2000/svg","line");Me.setAttribute("x1",He.toString()),Me.setAttribute("y1",ze.toString()),Me.setAttribute("x2",re.toString()),Me.setAttribute("y2",ze.toString()),Me.setAttribute("stroke",Ae),Me.setAttribute("stroke-width","3"),Me.setAttribute("opacity",$e.toString()),Me.setAttribute("pointer-events","none"),Me.setAttribute("z-index","50"),Ce&&Me.setAttribute("style",`filter: ${Ce};`),y.appendChild(Me),y.style.zIndex="1",console.log("Line created with color:",Ae)})}Oa(()=>{Z(),setTimeout(()=>{const y=Array.from(new Set(Object.values(p()).map(m=>m.majorTaskId).filter(Boolean)));for(const m of y){const q=Object.values(p()).filter(F=>F.majorTaskId===m).map(F=>n().findIndex(Q=>Q.toISOString().split("T")[0]===F.date)+1).filter(F=>F>0);if(q.length>0){const F=Math.min(...q),L=Math.max(...q);Xt(()=>Promise.resolve().then(()=>Gt),void 0,import.meta.url).then(Q=>{Q.updateMajorTask(m,{startDay:F,endDay:L})})}}},0)});const Ie=dt.subscribe(()=>Z()),ne=Ve.subscribe(()=>Z());let C=[];Lt(()=>{e(he)&&e(he).addEventListener("scroll",Z),setTimeout(()=>{const y=Array.from(document.querySelectorAll('[id^="subtask-"]')),m=Array.from(document.querySelectorAll('[id^="major-task-"]'));[...y,...m].forEach(N=>{const q=new ResizeObserver(()=>Z());q.observe(N),C.push(q)})},500)}),na(()=>{e(he)&&e(he).removeEventListener("scroll",Z),C.forEach(y=>y.disconnect()),C=[],Ie(),ne()}),Ze();var u=hn(),D=d(l(u),2),ce=d(l(D),2);Re(ce,1,n,Ue,(y,m,N)=>{var q=pn();let F;var L=l(q),Q=l(L,!0);o(L);var U=d(L,2);let ue;var X=l(U,!0);o(U),o(q),me((fe,le,ke,re)=>{F=Ne(q,1,"day-header svelte-1q5lr4u",null,F,fe),ye(Q,le),ue=Ne(U,1,"day-number",null,ue,ke),ye(X,re)},[()=>({today:W()(e(m)),past:$(e(m))}),()=>(R(g()),j(()=>g()[N].toUpperCase())),()=>({"today-number":W()(e(m))}),()=>(R(x()),e(m),j(()=>x()(e(m))))]),k(y,q)}),o(D);var se=d(D,2);nn(se,{get weekDates(){return n()}});var Te=d(se,2),I=l(Te);Re(I,1,i,Ue,(y,m,N)=>{var q=yn(),F=l(q),L=l(F,!0);o(F);var Q=d(F,2);Re(Q,1,n,Ue,(U,ue)=>{const X=rt(()=>(e(ue),j(()=>e(ue).toISOString().split("T")[0]))),fe=rt(()=>`${e(X)}|${e(m)}`);var le=gn();let ke;me(re=>ke=Ne(le,1,"calendar-cell svelte-1q5lr4u",null,ke,re),[()=>({"current-hour":W()(e(ue))&&Se===N,"past-cell":$(e(ue)),"drop-target":e(de)&&e(fe)!==e(J)&&!p()[e(fe)]})]),E("mouseup",le,()=>te(e(X),e(m))),E("click",le,re=>{re.stopPropagation(),je(e(X),e(m))}),k(U,le)}),o(q),me(()=>{Xe(q,`height: ${S()??""}px;`),ye(L,e(m))}),k(y,q)});var ie=d(I,2);Re(ie,5,()=>(R(p()),j(()=>Object.values(p()))),Ue,(y,m)=>{const N=rt(()=>(R(n()),e(m),j(()=>n().findIndex(U=>U.toISOString().split("T")[0]===e(m).date)))),q=rt(()=>(R(i()),e(m),j(()=>i().findIndex(U=>U===e(m).startTime))));var F=wt(),L=lt(F);{var Q=U=>{{let ue=rt(()=>e(N)+1),X=rt(()=>e(q)+1),fe=rt(()=>(e(de),e(m),j(()=>e(de)===`${e(m).date}|${e(m).startTime}`)));bn(U,{get subtask(){return e(m)},get pixelsPerHour(){return S()},get gridColumn(){return e(ue)},get gridRow(){return e(X)},get isBeingDragged(){return e(fe)},onDragStart:()=>pe(`${e(m).date}|${e(m).startTime}`),onClick:()=>V(e(m)),onResize:(le,ke)=>A()(e(m).id,le,ke),onStatusChange:le=>f()(e(m).id,le)})}};_e(L,U=>{e(N)!==-1&&e(q)!==-1&&U(Q)})}k(y,F)}),o(ie),o(Te),Fa(Te,y=>s(he,y),()=>e(he)),o(u),me(()=>{Xe(Te,`--pixels-per-hour: ${S()??""}px; position: relative;`),Xe(ie,`grid-template-rows: repeat(${R(i()),j(()=>i().length)??""}, ${S()??""}px);`)}),k(t,u),et()}var kn=H('<div class="duration-display svelte-18033iz"><span class="duration-icon svelte-18033iz">‚è±Ô∏è</span> <span class="duration-text svelte-18033iz">Duration: <strong class="svelte-18033iz"> </strong></span></div>'),wn=H("<option> </option>"),Sn=H('<button class="delete-button svelte-18033iz"><span class="button-icon svelte-18033iz">üóëÔ∏è</span> <span>Delete</span></button>'),Tn=H('<div class="modal-overlay svelte-18033iz" role="button" tabindex="-1"><div class="modal-content svelte-18033iz" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="modal-header svelte-18033iz"><div class="header-content svelte-18033iz"><div class="icon-wrapper svelte-18033iz"><!></div> <h2 id="modal-title" class="svelte-18033iz"> </h2></div> <button class="close-button svelte-18033iz" aria-label="Close modal">√ó</button></div> <div class="modal-body svelte-18033iz"><div class="form-group svelte-18033iz"><label for="date" class="svelte-18033iz"><span class="label-text svelte-18033iz">Date</span> <span class="label-required svelte-18033iz">*</span></label> <input id="date" type="date" class="modal-input date-input svelte-18033iz" required/></div> <div class="form-group svelte-18033iz"><label for="title" class="svelte-18033iz"><span class="label-text svelte-18033iz">Title</span> <span class="label-required svelte-18033iz">*</span></label> <input id="title" type="text" placeholder="What do you need to do?" class="modal-input svelte-18033iz" required/></div> <div class="time-inputs svelte-18033iz"><div class="form-group svelte-18033iz"><label for="startTime" class="svelte-18033iz"><span class="label-text svelte-18033iz">Start Time</span> <span class="label-required svelte-18033iz">*</span></label> <input id="startTime" type="time" class="modal-input time-input svelte-18033iz" required/></div> <div class="form-group svelte-18033iz"><label for="endTime" class="svelte-18033iz"><span class="label-text svelte-18033iz">End Time</span> <span class="label-required svelte-18033iz">*</span></label> <input id="endTime" type="time" class="modal-input time-input svelte-18033iz" required/></div></div> <!> <div class="form-group svelte-18033iz"><label for="priority" class="svelte-18033iz"><span class="label-text svelte-18033iz">Priority</span></label> <select id="priority" class="modal-select svelte-18033iz"><option>üî¥ High</option><option>üü° Medium</option><option>üü¢ Low</option></select></div> <div class="form-group svelte-18033iz"><label for="description" class="svelte-18033iz"><span class="label-text svelte-18033iz">Description</span> <span class="label-optional svelte-18033iz">(optional)</span></label> <textarea id="description" placeholder="Add any additional details..." class="modal-textarea svelte-18033iz" rows="4"></textarea></div> <div class="form-group svelte-18033iz"><label for="majorTaskDropdown" class="svelte-18033iz"><span class="label-text svelte-18033iz">Link to Major Task</span></label> <select id="majorTaskDropdown" class="modal-input svelte-18033iz"></select></div></div> <div class="modal-footer svelte-18033iz"><!> <div class="action-buttons svelte-18033iz"><button class="cancel-button svelte-18033iz">Cancel</button> <button class="save-button svelte-18033iz"><span class="button-icon svelte-18033iz"> </span> <span> </span></button></div></div></div></div>');function Dn(t,a){Qe(a,!1);const n=()=>St(Ge,"$majorTasks",i),[i,g]=Ct(),p=b();let S=z(a,"showModal",8,!1),w=z(a,"modalMode",8,"create"),x=z(a,"targetDate",12,""),W=z(a,"startTimeInput",12,""),B=z(a,"endTimeInput",12,""),Y=z(a,"titleInput",12,""),A=z(a,"descriptionInput",12,""),f=z(a,"majorTaskIdInput",12,""),Se=z(a,"selectedEvent",8,null),de=z(a,"priorityInput",12,"medium"),J=z(a,"onClose",8),he=z(a,"onSave",8),je=z(a,"onDelete",8),$=b(!1);function pe(){he()()}function te(C){C.key==="Escape"&&J()()}function V(C){C.stopPropagation()}function ae(C,u){if(!C||!u)return"";const[D,ce]=C.split(":").map(Number),[se,Te]=u.split(":").map(Number),I=D*60+ce,y=se*60+Te-I;if(y<=0)return"Invalid duration";const m=Math.floor(y/60),N=y%60;return m===0?`${N}m`:N===0?`${m}h`:`${m}h ${N}m`}we(()=>(R(S()),R(w()),R(Se()),e($)),()=>{S()&&w()==="view"&&Se()&&!e($)&&(f(Se().majorTaskId||""),s($,!0))}),we(()=>R(S()),()=>{S()||s($,!1)}),we(()=>(R(S()),R(w()),n(),R(f()),e($)),()=>{S()&&w()==="create"&&n().length>0&&!f()&&!e($)&&(f(n()[0].id),s($,!0))}),we(()=>(R(W()),R(B())),()=>{s(p,ae(W(),B()))}),gt(),Ze();var Z=wt(),Ie=lt(Z);{var ne=C=>{var u=Tn(),D=l(u),ce=l(D),se=l(ce),Te=l(se),I=l(Te);{var ie=T=>{var P=We("‚ûï");k(T,P)},y=T=>{var P=We("üìã");k(T,P)};_e(I,T=>{w()==="create"?T(ie):T(y,!1)})}o(Te);var m=d(Te,2),N=l(m,!0);o(m),o(se);var q=d(se,2);o(ce);var F=d(ce,2),L=l(F),Q=d(l(L),2);bt(Q),o(L);var U=d(L,2),ue=d(l(U),2);bt(ue),o(U);var X=d(U,2),fe=l(X),le=d(l(fe),2);bt(le),o(fe);var ke=d(fe,2),re=d(l(ke),2);bt(re),o(ke),o(X);var ze=d(X,2);{var qe=T=>{var P=kn(),xe=d(l(P),2),Le=d(l(xe)),Ee=l(Le,!0);o(Le),o(xe),o(P),me(()=>ye(Ee,e(p))),k(T,P)};_e(ze,T=>{e(p)&&T(qe)})}var Oe=d(ze,2),Be=d(l(Oe),2);me(()=>{de(),qt(()=>{})});var Ae=l(Be);Ae.value=Ae.__value="high";var $e=d(Ae);$e.value=$e.__value="medium";var Ce=d($e);Ce.value=Ce.__value="low",o(Be),o(Oe);var De=d(Oe,2),He=d(l(De),2);sa(He),o(De);var Me=d(De,2),Fe=d(l(Me),2);me(()=>{f(),qt(()=>{n()})}),Re(Fe,5,n,Ue,(T,P)=>{var xe=wn(),Le=l(xe,!0);o(xe);var Ee={};me(()=>{ye(Le,(e(P),j(()=>e(P).title))),Ee!==(Ee=(e(P),j(()=>e(P).id)))&&(xe.value=(xe.__value=(e(P),j(()=>e(P).id)))??"")}),k(T,xe)}),o(Fe),o(Me),o(F);var tt=d(F,2),G=l(tt);{var K=T=>{var P=Sn();E("click",P,function(...xe){je()?.apply(this,xe)}),k(T,P)};_e(G,T=>{w()==="view"&&T(K)})}var c=d(G,2),_=l(c),M=d(_,2),ee=l(M),ve=l(ee,!0);o(ee);var oe=d(ee,2),ge=l(oe,!0);o(oe),o(M),o(c),o(tt),o(D),o(u),me(()=>{ye(N,w()==="create"?"Create New Subtask":"Subtask Details"),ye(ve,w()==="create"?"‚úì":"üíæ"),ye(ge,w()==="create"?"Create":"Update")}),E("click",q,function(...T){J()?.apply(this,T)}),at(Q,x),at(ue,Y),at(le,W),at(re,B),Ft(Be,de),at(He,A),Ft(Fe,f),E("click",_,function(...T){J()?.apply(this,T)}),E("click",M,pe),E("click",D,La(function(T){Ra.call(this,a,T)})),E("keydown",D,V),E("click",u,function(...T){J()?.apply(this,T)}),E("keydown",u,te),k(C,u)};_e(Ie,C=>{S()&&C(ne)})}k(t,Z),et(),g()}var Mn=H('<div class="error-message svelte-mtbej3"> </div>'),jn=H('<div class="error-messages svelte-mtbej3"><div class="error-icon svelte-mtbej3">‚ö†Ô∏è</div> <div class="error-list svelte-mtbej3"></div></div>'),In=H('<span class="checkmark svelte-mtbej3">‚úì</span>'),xn=H('<button type="button"><!></button>'),Cn=H('<div class="custom-color-picker svelte-mtbej3"><div class="color-picker-header svelte-mtbej3"><span class="picker-label svelte-mtbej3">Pick your color:</span></div> <div class="color-picker-controls svelte-mtbej3"><input type="color" class="color-input svelte-mtbej3" aria-label="Color picker"/> <div class="color-preview svelte-mtbej3"></div> <button type="button" class="apply-color-btn svelte-mtbej3">Apply</button></div></div>'),En=H('<div class="days-summary svelte-mtbej3"><span class="summary-icon svelte-mtbej3">üìÖ</span> <span class="summary-text svelte-mtbej3"> </span></div>'),zn=H('<span class="day-check svelte-mtbej3">‚úì</span>'),On=H('<button type="button"><span class="day-text svelte-mtbej3"> </span> <!></button>'),An=H(`<div class="modal-overlay svelte-mtbej3" role="button" tabindex="0"><div class="modal-content svelte-mtbej3" role="dialog" aria-modal="true"><div class="modal-header svelte-mtbej3"><div class="header-content svelte-mtbej3"><div class="icon-wrapper svelte-mtbej3">üìå</div> <h2 class="svelte-mtbej3">Create Major Task</h2></div> <button type="button" class="close-button svelte-mtbej3" aria-label="Close">√ó</button></div> <div class="modal-body svelte-mtbej3"><!> <div class="form-group svelte-mtbej3"><label for="task-title" class="svelte-mtbej3"><span class="label-text svelte-mtbej3">Title</span> <span class="label-required svelte-mtbej3">*</span></label> <input type="text" id="task-title" placeholder="What's the task?" class="form-input svelte-mtbej3" required/></div> <div class="form-group svelte-mtbej3"><label for="task-description" class="svelte-mtbej3"><span class="label-text svelte-mtbej3">Description</span> <span class="label-optional svelte-mtbej3">(optional)</span></label> <textarea id="task-description" placeholder="Add details about this task..." class="form-textarea svelte-mtbej3" rows="3"></textarea></div> <div class="form-group svelte-mtbej3"><label for="task-priority" class="svelte-mtbej3"><span class="label-text svelte-mtbej3">Priority</span></label> <select id="task-priority" class="form-select svelte-mtbej3"><option class="svelte-mtbej3">üî¥ High</option><option class="svelte-mtbej3">üü° Medium</option><option class="svelte-mtbej3">üü¢ Low</option></select></div> <div class="form-group svelte-mtbej3"><fieldset class="svelte-mtbej3"><legend class="svelte-mtbej3"><span class="label-text svelte-mtbej3">Color</span> <span class="label-required svelte-mtbej3">*</span></legend> <div class="color-selection svelte-mtbej3"><!> <button type="button" title="Custom color" aria-label="Choose custom color"><span class="custom-icon svelte-mtbej3">üé®</span></button></div> <!></fieldset></div> <div class="form-group svelte-mtbej3"><fieldset class="svelte-mtbej3"><legend class="svelte-mtbej3"><span class="label-text svelte-mtbej3">Days</span> <span class="label-required svelte-mtbej3">*</span></legend> <!> <div class="day-selection svelte-mtbej3"></div></fieldset></div></div> <div class="modal-footer svelte-mtbej3"><button type="button" class="cancel-button svelte-mtbej3">Cancel</button> <button type="button" class="create-button svelte-mtbej3"><span class="button-icon svelte-mtbej3">‚úì</span> <span class="svelte-mtbej3">Create Task</span></button></div></div></div>`);function $n(t,a){Qe(a,!1);const n=b();let i=z(a,"showModal",12,!1);const g=Aa();let p=b(""),S=b(""),w=b(""),x=b(new Set),W=b("medium"),B=b(!1),Y=b("#ff0000"),A=b([]);const f=[{name:"Red",value:"#dc3545"},{name:"Blue",value:"#007bff"},{name:"Green",value:"#28a745"},{name:"Yellow",value:"#ffc107"},{name:"Orange",value:"#fd7e14"},{name:"Purple",value:"#8c62cf"},{name:"Pink",value:"#e83e8c"},{name:"Teal",value:"#20c997"}],Se=[{short:"Mon",full:"Monday"},{short:"Tue",full:"Tuesday"},{short:"Wed",full:"Wednesday"},{short:"Thu",full:"Thursday"},{short:"Fri",full:"Friday"},{short:"Sat",full:"Saturday"},{short:"Sun",full:"Sunday"}];function de(){if(e(x).size===0)return"";if(e(x).size===7)return"All week";const u=Array.from(e(x)).sort((se,Te)=>se-Te),D=u.map(se=>Se[se-1].short);if(u.length<=2)return D.join(" & ");let ce=!0;for(let se=1;se<u.length;se++)if(u[se]!==u[se-1]+1){ce=!1;break}return ce?`${D[0]} - ${D[D.length-1]}`:D.join(", ")}function J(){return s(A,[]),e(p).trim()||e(A).push("Title is required"),e(w)||e(A).push("Please select a color"),e(x).size===0&&e(A).push("Please select at least one day"),e(A).length===0}function he(){if(J()){const u=Array.from(e(x)).sort((ce,se)=>ce-se),D={title:e(p).trim(),description:e(S).trim(),color:e(w),startDay:u[0],endDay:u[u.length-1],selectedDays:u,priority:e(W)};g("create",D),je(),$()}}function je(){s(p,""),s(S,""),s(w,""),s(x,new Set),s(W,"medium"),s(B,!1),s(A,[])}function $(){je(),i(!1),g("close")}function pe(u){s(w,u),s(B,!1)}function te(){s(w,e(Y)),s(B,!1)}function V(u){e(x).has(u)?e(x).delete(u):e(x).add(u),s(x,e(x))}function ae(u){u.key==="Escape"&&$()}function Z(u){u.target===u.currentTarget&&$()}we(()=>{},()=>{s(n,de())}),gt(),Ze();var Ie=wt();E("keydown",$a,ae);var ne=lt(Ie);{var C=u=>{var D=An(),ce=l(D),se=l(ce),Te=d(l(se),2);o(se);var I=d(se,2),ie=l(I);{var y=G=>{var K=jn(),c=d(l(K),2);Re(c,5,()=>e(A),Ue,(_,M)=>{var ee=Mn(),ve=l(ee,!0);o(ee),me(()=>ye(ve,e(M))),k(_,ee)}),o(c),o(K),k(G,K)};_e(ie,G=>{e(A),j(()=>e(A).length>0)&&G(y)})}var m=d(ie,2),N=d(l(m),2);bt(N),o(m);var q=d(m,2),F=d(l(q),2);sa(F),o(q);var L=d(q,2),Q=d(l(L),2);me(()=>{e(W),qt(()=>{})});var U=l(Q);U.value=U.__value="high";var ue=d(U);ue.value=ue.__value="medium";var X=d(ue);X.value=X.__value="low",o(Q),o(L);var fe=d(L,2),le=l(fe),ke=d(l(le),2),re=l(ke);Re(re,1,()=>f,Ue,(G,K)=>{var c=xn();let _;var M=l(c);{var ee=ve=>{var oe=In();k(ve,oe)};_e(M,ve=>{e(w),e(K),j(()=>e(w)===e(K).value)&&ve(ee)})}o(c),me(ve=>{_=Ne(c,1,"color-box svelte-mtbej3",null,_,ve),Xe(c,`background-color: ${e(K),j(()=>e(K).value)??""}`),pt(c,"title",(e(K),j(()=>e(K).name))),pt(c,"aria-label",(e(K),j(()=>e(K).name)))},[()=>({selected:e(w)===e(K).value})]),E("click",c,()=>pe(e(K).value)),k(G,c)});var ze=d(re,2);let qe;o(ke);var Oe=d(ke,2);{var Be=G=>{var K=Cn(),c=d(l(K),2),_=l(c);bt(_);var M=d(_,2),ee=d(M,2);o(c),o(K),me(()=>Xe(M,`background-color: ${e(Y)??""}`)),at(_,()=>e(Y),ve=>s(Y,ve)),E("click",ee,te),k(G,K)};_e(Oe,G=>{e(B)&&G(Be)})}o(le),o(fe);var Ae=d(fe,2),$e=l(Ae),Ce=d(l($e),2);{var De=G=>{var K=En(),c=d(l(K),2),_=l(c,!0);o(c),o(K),me(()=>ye(_,e(n))),k(G,K)};_e(Ce,G=>{e(n)&&G(De)})}var He=d(Ce,2);Re(He,5,()=>Se,Ue,(G,K,c)=>{var _=On();let M;var ee=l(_),ve=l(ee,!0);o(ee);var oe=d(ee,2);{var ge=T=>{var P=zn();k(T,P)};_e(oe,T=>{e(x),j(()=>e(x).has(c+1))&&T(ge)})}o(_),me(T=>{M=Ne(_,1,"day-button svelte-mtbej3",null,M,T),pt(_,"title",(e(K),j(()=>e(K).full))),ye(ve,(e(K),j(()=>e(K).short)))},[()=>({selected:e(x).has(c+1)})]),E("click",_,()=>V(c+1)),k(G,_)}),o(He),o($e),o(Ae),o(I);var Me=d(I,2),Fe=l(Me),tt=d(Fe,2);o(Me),o(ce),o(D),me(G=>qe=Ne(ze,1,"color-box custom-color-trigger svelte-mtbej3",null,qe,G),[()=>({selected:e(B)})]),E("click",Te,$),at(N,()=>e(p),G=>s(p,G)),at(F,()=>e(S),G=>s(S,G)),Ft(Q,()=>e(W),G=>s(W,G)),E("click",ze,()=>s(B,!e(B))),E("click",Fe,$),E("click",tt,he),E("click",D,Z),E("keydown",D,ae),k(u,D)};_e(ne,u=>{i()&&u(C)})}k(t,Ie),et()}var Pn=H('<div class="weekday"> </div>'),Nn=H("<button><!></button>"),qn=H('<div class="week-row svelte-18nbe3o"></div>'),Fn=H('<div class="month-calendar svelte-18nbe3o"><div class="month-controls svelte-18nbe3o"><button class="nav svelte-18nbe3o" aria-label="Previous month">‚Äπ</button> <div class="month-label svelte-18nbe3o"> </div> <button class="nav svelte-18nbe3o" aria-label="Next month">‚Ä∫</button></div> <div class="month-grid svelte-18nbe3o"><div class="weekdays svelte-18nbe3o"></div> <!></div></div>');function Ln(t,a){Qe(a,!1);let n=z(a,"selectedDate",28,()=>new Date),i=z(a,"viewDate",28,()=>new Date);function g($){$!==null&&n(new Date(i().getFullYear(),i().getMonth(),$))}function p(){i(new Date(i().getFullYear(),i().getMonth()-1,1))}function S(){i(new Date(i().getFullYear(),i().getMonth()+1,1))}function w($){const pe=$.getFullYear(),te=$.getMonth(),V=new Date(pe,te,1),Z=new Date(pe,te+1,0).getDate(),Ie=(V.getDay()+6)%7,ne=[];let C=Array(7).fill(null),u=1;for(let D=Ie;D<7;D++)C[D]=u++;for(ne.push(C.slice());u<=Z;){C=Array(7).fill(null);for(let D=0;D<7&&u<=Z;D++)C[D]=u++;ne.push(C.slice())}return ne}const x=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function W($,pe){return $.getFullYear()===pe.getFullYear()&&$.getMonth()===pe.getMonth()&&$.getDate()===pe.getDate()}Ze();var B=Fn(),Y=l(B),A=l(Y),f=d(A,2),Se=l(f,!0);o(f);var de=d(f,2);o(Y);var J=d(Y,2),he=l(J);Re(he,5,()=>x,Ue,($,pe)=>{var te=Pn(),V=l(te,!0);o(te),me(()=>ye(V,e(pe))),k($,te)}),o(he);var je=d(he,2);Re(je,1,()=>(R(i()),j(()=>w(i()))),Ue,($,pe)=>{var te=qn();Re(te,5,()=>e(pe),Ue,(V,ae)=>{var Z=Nn();let Ie;var ne=l(Z);{var C=u=>{var D=We();me(()=>ye(D,e(ae))),k(u,D)};_e(ne,u=>{e(ae)!==null&&u(C)})}o(Z),me((u,D)=>{Ie=Ne(Z,1,"day-cell svelte-18nbe3o",null,Ie,u),Z.disabled=e(ae)===null,pt(Z,"aria-pressed",D)},[()=>({selected:e(ae)!==null&&W(new Date(i().getFullYear(),i().getMonth(),e(ae)),n())}),()=>(e(ae),R(i()),R(n()),j(()=>e(ae)!==null&&W(new Date(i().getFullYear(),i().getMonth(),e(ae)),n())))]),E("click",Z,()=>g(e(ae))),k(V,Z)}),o(te),k($,te)}),o(J),o(B),me($=>ye(Se,$),[()=>(R(i()),j(()=>i().toLocaleString(void 0,{month:"long",year:"numeric"})))]),E("click",A,p),E("click",de,S),k(t,B),et()}const fa="daily_activity";function Rn(t){if(!(typeof window>"u"))try{localStorage.setItem(fa,JSON.stringify(t))}catch(a){console.warn("Failed to save daily activity to localStorage:",a)}}function Hn(){if(typeof window>"u")return[];try{const t=localStorage.getItem(fa);return t?JSON.parse(t):[]}catch(t){return console.warn("Failed to load daily activity from localStorage:",t),[]}}const ba=ct(Hn());ba.subscribe(Rn);function xt(t,a){ba.update(n=>{const i=n.find(g=>g.date===t);if(i){if(i.totalMinutes=Math.max(0,i.totalMinutes+a),i.totalMinutes===0)return n.filter(g=>g.date!==t)}else a>0&&n.push({date:t,totalMinutes:a});return[...n]})}async function Yn(t,a,n){if(!navigator.serviceWorker.controller){if(console.warn("Service Worker not controlling the page yet"),Notification.permission==="granted"){const i={body:a,icon:n?.icon||"üìÖ",badge:n?.badge||"üìÖ",tag:n?.tag||"notification",vibrate:n?.vibrate||[200,100,200],requireInteraction:n?.requireInteraction||!1,silent:n?.silent||!1};new Notification(t,i)}return}try{const i=await navigator.serviceWorker.ready,g={body:a,icon:n?.icon||"üìÖ",badge:n?.badge||"üìÖ",tag:n?.tag||"notification",vibrate:n?.vibrate||[200,100,200],requireInteraction:n?.requireInteraction||!1,silent:n?.silent||!1,data:{dateTime:new Date().toISOString(),url:"/"}};await i.showNotification(t,g),console.log("Mobile notification sent via Service Worker")}catch(i){console.error("Failed to show notification:",i)}}async function Wn(){return"Notification"in window?Notification.permission==="granted"?"granted":await Notification.requestPermission():(console.warn("This browser does not support notifications"),"denied")}async function Yt(t,a,n){if(!("Notification"in window))return console.warn("This browser does not support notifications"),null;if(Notification.permission!=="granted")return console.warn("Notification permission not granted"),null;if("serviceWorker"in navigator&&navigator.serviceWorker.controller)return await Yn(t,a,n),null;const i={body:a,icon:n?.icon||"üìÖ",badge:n?.badge||"üìÖ",tag:n?.tag||"calendar-notification",requireInteraction:n?.requireInteraction||!1,silent:n?.silent||!1};return n?.vibrate&&"vibrate"in navigator&&(i.vibrate=n.vibrate),new Notification(t,i)}let Zt=!1;async function pa(){Zt||(Zt=!0,await Wn())}function Un(t){pa(),Rt.success(`Event created: ${t.title}`,{duration:4e3,position:"bottom-right"}),Yt("Event Created",`${t.title} scheduled for ${t.date} at ${t.startTime}`,{icon:"/favicon.svg",tag:`event-created-${t.id}`})}function Bn(t){Rt.info(`Event updated: ${t.title}`,{duration:4e3,position:"bottom-right"}),Yt("Event Updated",`${t.title} has been modified`,{icon:"/favicon.svg",tag:`event-updated-${t.id}`})}function Kn(t){const a=ga(t);Rt.warning(`Reminder: ${t.title} starts in ${a} minutes`,{duration:6e3,position:"top-center",showClose:!0}),Yt("Event Reminder",`${t.title} starts in ${a} minutes`,{icon:"/favicon.svg",tag:`event-reminder-${t.id}`,requireInteraction:!0})}function ga(t){const a=new Date,[n,i,g]=t.date.split("-").map(Number),[p,S]=t.startTime.split(":").map(Number),w=new Date(n,i-1,g,p,S);return Math.floor((w.getTime()-a.getTime())/(1e3*60))}function Qt(t){const a=new Set(JSON.parse(localStorage.getItem("remindersSent")||"[]"));t.forEach(n=>{const i=ga(n),g=String(n.id);i>0&&i<=60&&!a.has(g)&&(Kn(n),a.add(g)),i<0&&a.delete(g)}),localStorage.setItem("remindersSent",JSON.stringify(Array.from(a)))}var Jn=H('<div slot="calendar"><!></div>'),Vn=H('<div class="task-summary svelte-1iu5iby"><div class="status-counts svelte-1iu5iby"><div> </div> <div> </div> <div> </div></div></div>'),Xn=H('<p class="no-results svelte-1iu5iby">No tasks match the current filters.</p>'),Gn=H('<div slot="content"><div class="filter-results svelte-1iu5iby"><p class="svelte-1iu5iby"><strong> </strong> of <strong> </strong> tasks shown</p> <!></div></div>'),Zn=H('<button class="fab-option svelte-1iu5iby"><span class="fab-icon svelte-1iu5iby">üìã</span> <span class="fab-label svelte-1iu5iby">Major Task</span></button> <button class="fab-option svelte-1iu5iby"><span class="fab-icon svelte-1iu5iby">‚úì</span> <span class="fab-label svelte-1iu5iby">Subtask</span></button>',1),Qn=H('<div><!> <div class="calendar-container svelte-1iu5iby"><div class="calendar-header svelte-1iu5iby"><button class="svelte-1iu5iby">‚Üê</button> <button class="svelte-1iu5iby">Today</button> <div class="week-display svelte-1iu5iby"> </div> <button class="svelte-1iu5iby">‚Üí</button> <div class="zoom-controls svelte-1iu5iby"><button title="Zoom out" class="svelte-1iu5iby">‚àí</button> <button title="Reset zoom" class="svelte-1iu5iby">‚äô</button> <button title="Zoom in" class="svelte-1iu5iby">+</button></div></div> <!> <!> <!></div> <div class="fab-container svelte-1iu5iby"><!> <button> </button></div></div>');function es(t,a){Qe(a,!1);const n=()=>St(Dt,"$subtasks",i),[i,g]=Ct(),p=b(),S=b();let w=b({}),x=b(!1),W=b(!1),B=b("create"),Y=b(null),A=b(""),f=b(""),Se=b(""),de=b(""),J=b(""),he=b("medium"),je=b(!1),$=b(""),pe=b(""),te=b(new Date),V=b(new Date(e(te).getFullYear(),e(te).getMonth(),1)),ae=b(!0),Z=b(!1);function Ie(r){s(Z,r.detail.collapsed)}let ne=b([]),C=b({}),u=b(null),D=b([]),ce=b(60);const se=30,Te=120;let I=b(0);const ie=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],y=Array.from({length:24},(r,v)=>`${v.toString().padStart(2,"0")}:00`);function m(r){const v=new Date,h=v.getDay(),O=h===0?-6:1-h,be=new Date(v);return be.setDate(v.getDate()+O+r*7),Array.from({length:7},(Pe,Je)=>{const Ke=new Date(be);return Ke.setDate(be.getDate()+Je),Ke})}function N(r){return r.getDate().toString()}function q(r){const v=new Date;return r.getDate()===v.getDate()&&r.getMonth()===v.getMonth()&&r.getFullYear()===v.getFullYear()}function F(r){if(r.length===0)return"";const v=r[0],h=r[6],O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],be=`${O[v.getMonth()]} ${v.getDate()}`,Pe=`${O[h.getMonth()]} ${h.getDate()}`;return`${be} - ${Pe}`}function L(r,v){const h=`${r}|${v}`,O=e(w)[h];console.log("handleCellClick:",{key:h,existing:O}),O?(console.log("handleCellClick: opening view modal"),U(O,r)):(console.log("handleCellClick: opening create modal"),Q(r,v))}function Q(r,v){console.log("openCreateModal called:",r,v),s(B,"create"),s(A,r);const[h,O]=v.split(":").map(Number),Pe=`${((h+1)%24).toString().padStart(2,"0")}:${O.toString().padStart(2,"0")}`;s(f,v),s(Se,Pe),s(de,""),s(J,""),s(he,"medium"),s(Y,null),s(x,!0)}function U(r,v,h){s(B,"view"),s(A,v),s(f,r.startTime),s(Se,r.endTime),s(de,r.title),s(J,r.description),s(Y,r),s(x,!0)}function ue(){const r=it(e(f));if(it(e(Se))<=r){alert("End time must be after start time");return}if(e(B)==="create"){const h=cn(e(A),e(f),e(Se),e(de),e(J),"pending",e(pe)||void 0,void 0,e(he));Dt.update(O=>[...O,h]),Un(h)}else if(e(Y)){const h=e(Y).id;ot(h,{startTime:e(f),endTime:e(Se),title:e(de),description:e(J),majorTaskId:e(pe)||void 0,priority:e(he)});const O=n().find(be=>be.id===h);O&&Bn(O)}s(x,!1)}function X(){e(Y)&&un(e(Y).id),s(x,!1)}function fe(){s(x,!1)}function le(r,v){const h=`${r.date}|${r.time}`,O=e(w)[h];if(O){const be=it(O.startTime),Je=it(O.endTime)-be,nt=it(v.time)+Je;if(O.status==="completed"&&r.date!==v.date){const jt=Pt(O),Et=O.completedOnDate||r.date;xt(Et,-jt),xt(v.date,jt),ot(O.id,{date:v.date,startTime:v.time,endTime:It(nt),completedOnDate:v.date})}else ot(O.id,{date:v.date,startTime:v.time,endTime:It(nt)})}}function ke(r){U(r,r.date,r.startTime)}function re(r,v){const h=n().find(be=>be.id===r);if(!h)return;const O=h.status;if(v==="completed"&&O!=="completed"){const be=new Date(h.date+"T"+h.endTime);if((new Date().getTime()-be.getTime())/(1e3*60*60)<=24){const Ke=Pt(h);xt(h.date,Ke),ot(r,{status:v,completedOnDate:h.date})}else ot(r,{status:v});return}if(O==="completed"&&v!=="completed"){const be=Pt(h),Pe=h.completedOnDate||h.date;xt(Pe,-be)}ot(r,{status:v})}function ze(r,v,h){ot(r,{startTime:It(v),endTime:It(h)})}function qe(){s(je,!e(je))}function Oe(){s(je,!1),s(W,!0)}function Be(){s(je,!1);const r=new Date().toISOString().split("T")[0];Q(r,"09:00")}function Ae(r){if(e($)){const v=r.detail,h=da(e($),v.title,v.description,v.color,v.startDay,v.endDay,v.priority);Ge.update(O=>[...O,h])}s(W,!1)}function $e(){s(W,!1)}function Ce(){s(ce,Math.min(Te,e(ce)+10))}function De(){s(ce,Math.max(se,e(ce)-10))}function He(){s(ce,60)}function Me(){Vt(I,-1)}function Fe(){Vt(I)}function tt(){s(I,0)}Lt(()=>{pa();const r=setInterval(()=>{Qt(n())},300*1e3);return Qt(n()),()=>clearInterval(r)}),we(()=>n(),()=>{s(p,n().map(r=>({id:r.id,title:r.title,status:r.status,priority:r.priority,date:r.date,startTime:r.startTime,endTime:r.endTime,description:r.description})))}),we(()=>(n(),e(C),e(u)),()=>{let r=[...n()];if(e(C).status&&e(C).status.length>0&&(r=r.filter(v=>e(C).status.includes(v.status))),e(C).priority&&e(C).priority.length>0&&(r=r.filter(v=>e(C).priority.includes(v.priority))),e(u)){if(e(u)==="date")r.sort((v,h)=>new Date(v.date).getTime()-new Date(h.date).getTime());else if(e(u)==="status"){const v={pending:0,completed:1,cancelled:2};r.sort((h,O)=>v[h.status]-v[O.status])}else if(e(u)==="priority"){const v={high:0,medium:1,low:2};r.sort((h,O)=>v[h.priority]-v[O.priority])}}s(ne,r)}),we(()=>(e(te),e(I)),()=>{if(e(te)){const r=new Date,v=r.getDay(),h=v===0?-6:1-v,O=new Date(r);O.setDate(r.getDate()+h);const be=e(te).getDay(),Pe=be===0?-6:1-be,Je=new Date(e(te));Je.setDate(e(te).getDate()+Pe);const Ke=Je.getTime()-O.getTime(),nt=Math.round(Ke/(10080*60*1e3));nt!==e(I)&&s(I,nt)}}),we(()=>e(I),()=>{s(S,m(e(I)))}),we(()=>(e(S),Tt),()=>{e(S).length>0&&s($,Tt(e(S)[0]))}),we(()=>e(ne),()=>{s(w,{}),e(ne).forEach(r=>{const v=`${r.date}|${r.startTime}`;Pa(w,e(w)[v]=r)})}),gt(),Ze();var G=Qn();let K;var c=l(G);Ha(c,{title:"Calendar & Tasks",get items(){return e(p)},get visible(){return e(ae)},set visible(r){s(ae,r)},get selectedFilters(){return e(C)},set selectedFilters(r){s(C,r)},get selectedSortId(){return e(u)},set selectedSortId(r){s(u,r)},get filteredItems(){return e(D)},set filteredItems(r){s(D,r)},$$events:{toggle:Ie},$$slots:{calendar:(r,v)=>{var h=Jn(),O=l(h);Ln(O,{get selectedDate(){return e(te)},set selectedDate(be){s(te,be)},get viewDate(){return e(V)},set viewDate(be){s(V,be)},$$legacy:!0}),o(h),k(r,h)},content:(r,v)=>{var h=Gn(),O=l(h),be=l(O),Pe=l(be),Je=l(Pe,!0);o(Pe);var Ke=d(Pe,2),nt=l(Ke,!0);o(Ke),Na(),o(be);var jt=d(be,2);{var Et=mt=>{var yt=Vn(),Kt=l(yt),zt=l(Kt),ka=l(zt);o(zt);var Ot=d(zt,2),wa=l(Ot);o(Ot);var Jt=d(Ot,2),Sa=l(Jt);o(Jt),o(Kt),o(yt),me((st,Ta,Da)=>{ye(ka,`Pending: ${st??""}`),ye(wa,`Completed: ${Ta??""}`),ye(Sa,`Cancelled: ${Da??""}`)},[()=>(e(ne),j(()=>e(ne).filter(st=>st.status==="pending").length)),()=>(e(ne),j(()=>e(ne).filter(st=>st.status==="completed").length)),()=>(e(ne),j(()=>e(ne).filter(st=>st.status==="cancelled").length))]),k(mt,yt)},_a=mt=>{var yt=Xn();k(mt,yt)};_e(jt,mt=>{e(ne),j(()=>e(ne).length>0)?mt(Et):mt(_a,!1)})}o(O),o(h),me(()=>{ye(Je,(e(ne),j(()=>e(ne).length))),ye(nt,(n(),j(()=>n().length)))}),k(r,h)}},$$legacy:!0});var _=d(c,2),M=l(_),ee=l(M),ve=d(ee,2),oe=d(ve,2),ge=l(oe,!0);o(oe);var T=d(oe,2),P=d(T,2),xe=l(P),Le=d(xe,2),Ee=d(Le,2);o(P),o(M);var ut=d(M,2);_n(ut,{get weekDates(){return e(S)},get timeSlots(){return y},get daysOfWeek(){return ie},get eventsIndex(){return e(w)},get pixelsPerHour(){return e(ce)},handleCellClick:L,formatDate:N,isToday:q,onEventMove:le,onSubtaskClick:ke,onSubtaskResize:ze,onStatusChange:re});var Ye=d(ut,2);Dn(Ye,{get showModal(){return e(x)},get modalMode(){return e(B)},get selectedEvent(){return e(Y)},onClose:fe,onSave:ue,onDelete:X,get targetDate(){return e(A)},set targetDate(r){s(A,r)},get startTimeInput(){return e(f)},set startTimeInput(r){s(f,r)},get endTimeInput(){return e(Se)},set endTimeInput(r){s(Se,r)},get titleInput(){return e(de)},set titleInput(r){s(de,r)},get descriptionInput(){return e(J)},set descriptionInput(r){s(J,r)},get majorTaskIdInput(){return e(pe)},set majorTaskIdInput(r){s(pe,r)},get priorityInput(){return e(he)},set priorityInput(r){s(he,r)},$$legacy:!0});var vt=d(Ye,2);$n(vt,{get showModal(){return e(W)},set showModal(r){s(W,r)},$$events:{create:Ae,close:$e},$$legacy:!0}),o(_);var Wt=d(_,2),Ut=l(Wt);{var ya=r=>{var v=Zn(),h=lt(v),O=d(h,2);E("click",h,Oe),E("click",O,Be),k(r,v)};_e(Ut,r=>{e(je)&&r(ya)})}var Mt=d(Ut,2);let Bt;var ha=l(Mt,!0);o(Mt),o(Wt),o(G),me((r,v,h)=>{K=Ne(G,1,"calendar-shell svelte-1iu5iby",null,K,r),ye(ge,v),Bt=Ne(Mt,1,"fab-main svelte-1iu5iby",null,Bt,h),ye(ha,e(je)?"‚úï":"+")},[()=>({collapsed:e(Z)}),()=>(e(S),j(()=>F(e(S)))),()=>({active:e(je)})]),E("click",ee,Me),E("click",ve,tt),E("click",T,Fe),E("click",xe,De),E("click",Le,He),E("click",Ee,Ce),E("click",Mt,qe),k(t,G),et(),g()}var ts=H('<button class="feedback-button svelte-er6x5">üí¨ Give Feedback</button>');function as(t,a){let n=z(a,"formUrl",8);var i=ts();E("click",i,()=>window.open(n(),"_blank")),k(t,i)}var ns=H('<main><div class="calendar-wrapper svelte-13luymz"><!></div> <!></main>');function bs(t,a){Qe(a,!1),Lt(()=>{document.documentElement.style.setProperty("--background",ft.background),document.documentElement.style.setProperty("--bubbleBackground",ft.bubbleBackground),document.documentElement.style.setProperty("--buttonPrimary",ft.buttonPrimary),document.documentElement.style.setProperty("--buttonHover",ft.buttonHover),document.documentElement.style.setProperty("--buttonText",ft.buttonText),document.documentElement.style.setProperty("--textPrimary",ft.textPrimary)}),Ze();var n=ns(),i=l(n),g=l(i);es(g,{}),o(i);var p=d(i,2);as(p,{formUrl:"https://docs.google.com/forms/d/e/1FAIpQLSdZ-SvMCCUtNef0xh4V4pEj-rCvK7VwQjV50e05OuxgLJeNHQ/viewform?usp=dialog"}),o(n),k(t,n),et()}export{bs as component};
